(()=>{"use strict";console.log("=== Contex.ly Background Script Started ==="),chrome.runtime.onInstalled.addListener((()=>{console.log("Extension installed or updated"),chrome.contextMenus.create({id:"reframe-selection",title:"Reframe",contexts:["selection"]},(()=>{chrome.runtime.lastError?console.error("Error creating menu:",chrome.runtime.lastError):console.log("Menu created successfully")}))})),chrome.contextMenus.onClicked.addListener(((e,t)=>{if("reframe-selection"===e.menuItemId&&void 0!==(null==t?void 0:t.id)&&e.selectionText){const o=t.id;console.log("Contex.ly menu clicked with selection:",e.selectionText),chrome.tabs.sendMessage(o,{type:"EXPLAIN_TEXT",text:e.selectionText}).then((e=>{console.log("Message sent successfully, response:",e)})).catch((t=>{console.error("Error sending message:",t),chrome.scripting.executeScript({target:{tabId:o},files:["content.js"]}).then((()=>(console.log("Content script injected successfully"),chrome.tabs.sendMessage(o,{type:"EXPLAIN_TEXT",text:e.selectionText})))).then((e=>{console.log("Message sent successfully after injection, response:",e)})).catch((e=>{console.error("Error after injection:",e)}))}))}}))})();